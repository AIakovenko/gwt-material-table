!function(e,t){"use strict";function i(i,n){var s=this;s.$el=e(i),s.el=i,s.id=l++,s.name=s.name+s.id,s.$window=e(t),s.$document=e(document),s.$el.bind("destroyed",e.proxy(s.teardown,s)),s.$clonedHeader=null,s.$originalHeader=null,s.isSticky=!1,s.hasBeenSticky=!1,s.leftOffset=null,s.topOffset=null,s.scrollBarWidth=13,s.init=function(){s.$el.each(function(){var t=e(this);t.css("padding",0),s.$originalHeader=e("thead:first",this),s.$clonedHeader=s.$originalHeader.clone(),t.trigger("clonedHeader."+o,[s.$clonedHeader]),s.$clonedHeader.addClass("tableFloatingHeader"),s.$clonedHeader.css("display","none"),s.$originalHeader.addClass("tableFloatingHeaderOriginal"),s.$originalHeader.after(s.$clonedHeader),s.$clonedHeader.find(".stickyExclude").remove(),s.$printStyle=e('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),e("head").append(s.$printStyle)}),s.setOptions(n),s.updateWidth(),s.toggleHeaders(),s.bind()},s.destroy=function(){s.$el.unbind("destroyed",s.teardown),s.teardown()},s.teardown=function(){s.isSticky&&s.$originalHeader.css("position","static"),e.removeData(s.el,"plugin_"+o),s.unbind(),s.$clonedHeader.remove(),s.$originalHeader.removeClass("tableFloatingHeaderOriginal"),s.$originalHeader.css("visibility","visible"),s.$printStyle.remove(),s.el=null,s.$el=null},s.bind=function(){s.$scrollableArea.on("scroll."+o,s.toggleHeaders),s.$scrollableArea.find(".inner-scroll").on("scroll."+o,s.toggleHeaders),s.isWindowScrolling||(s.$window.on("scroll."+o+s.id,s.setPositionValues),s.$window.on("resize."+o+s.id,s.toggleHeaders)),s.$scrollableArea.on("resize."+o,s.toggleHeaders),s.$scrollableArea.on("resize."+o,s.updateWidth),s.$window.on("resize."+o,s.updateWidth),s.detectOuterScrolls()},s.unbind=function(){s.$scrollableArea.off("."+o,s.toggleHeaders),s.isWindowScrolling||(s.$window.off("."+o+s.id,s.setPositionValues),s.$window.off("."+o+s.id,s.toggleHeaders)),s.$scrollableArea.off("."+o,s.updateWidth),s.$window.off("."+o+s.id,s.updateWidth),s.$scrollableArea.parents().each(function(){e(this).off("."+o)})},s.detectOuterScrolls=function(){s.$scrollableArea.parents().each(function(){var t=e(this);t.off("."+o),t.hasScrollBar()&&t.on("scroll."+o,s.toggleHeaders)})},s.toggleHeaders=function(){s.$el&&s.$el.each(function(){var t,i=e(this),o=s.isWindowScrolling?isNaN(s.options.fixedOffset)?s.options.fixedOffset.outerHeight():s.options.fixedOffset:s.$scrollableArea.offset().top+(isNaN(s.options.fixedOffset)?0:s.options.fixedOffset),l=s.$scrollableArea.find(".inner-scroll"),a=i.offset(),n=l.scrollTop()+o,r=(l.scrollLeft(),s.isWindowScrolling?n>a.top:o>a.top);(s.isWindowScrolling?n:0)<a.top+i.height()-s.$clonedHeader.height()-(s.isWindowScrolling?0:o);r?(t=a.left+s.options.leftOffset,s.$originalHeader.css({position:"fixed","margin-top":s.options.marginTop,left:0,"-webkit-transform":"translate("+t+"px)","-ms-transform":"translate("+t+"px)","-transform":"translate("+t+"px)","z-index":3}),s.leftOffset=t,s.topOffset=o,s.$clonedHeader.css("display",""),s.isSticky||(s.isSticky=!0,s.updateWidth(),s.$el.trigger("sticky-change",[!0])),s.setPositionValues()):s.isSticky&&(s.$originalHeader.css("position","static"),s.$clonedHeader.css("display","none"),s.$originalHeader.css({"-webkit-transform":"","-ms-transform":"","-transform":""}),s.isSticky=!1,s.resetWidths(e("td,th",s.$clonedHeader),e("td,th",s.$originalHeader)),s.$el.trigger("sticky-change",[!1]))})},s.setPositionValues=function(){var t=s.$window.scrollTop(),i=s.$window.scrollLeft();if(!(!s.isSticky||0>i||i+s.$window.width()>s.$document.width())){s.detectOuterScrolls(),s.scrollBarWidth=e.scrollBarWidth(s.el);var o=s.$scrollableArea.find(".inner-scroll").scrollLeft(),l=o+s.getOuterScrollLeft(),a=s.getOuterScrollTop()-s.options.marginTop,n=s.$originalHeader.outerHeight(),r=s.topOffset-(s.isWindowScrolling?0:t),d=s.leftOffset-(s.isWindowScrolling?0:i);s.$originalHeader.css({top:0,left:0,"-webkit-transform":"translate("+d+"px, "+r+"px)","-ms-transform":"translate("+d+"px, "+r+"px)","-transform":"translate("+d+"px, "+r+"px)",clip:"rect("+a+"px, "+(s.$scrollableArea.outerWidth()+o-s.scrollBarWidth)+"px, "+(n+50)+"px, "+l+"px)"})}},s.updateWidth=function(){if(s.isSticky){s.$originalHeaderCells||(s.$originalHeaderCells=e('tr:not(".stickyExclude") th,td',s.$originalHeader)),s.$clonedHeaderCells||(s.$clonedHeaderCells=e('tr:not(".stickyExclude") th,td',s.$clonedHeader));var t=s.getWidths(s.$clonedHeaderCells);s.setWidths(t,s.$clonedHeaderCells,s.$originalHeaderCells),s.$originalHeader.css("width",s.$clonedHeader.width())}},s.getWidths=function(i){var o=[];return i.each(function(i){var l,a=e(this);if("border-box"===a.css("box-sizing"))l=a[0].getBoundingClientRect().width;else{var n=e("th",s.$originalHeader);if("collapse"===n.css("border-collapse"))if(t.getComputedStyle)l=parseFloat(t.getComputedStyle(this,null).width);else{var r=parseFloat(a.css("padding-left")),d=parseFloat(a.css("padding-right")),c=parseFloat(a.css("border-width"));l=a.outerWidth()-r-d-c}else l=a.width()}o[i]=l}),o},s.setWidths=function(e,t,i){t.each(function(t){var o=e[t];i.eq(t).css({"min-width":o,"max-width":o})})},s.resetWidths=function(t,i){t.each(function(t){var o=e(this);i.eq(t).css({"min-width":o.css("min-width"),"max-width":o.css("max-width")})})},s.getOuterScrollTop=function(){var t=0;return s.$scrollableArea.parents(":not(body,html)").each(function(){t+=e(this).scrollTop()}),t},s.getOuterScrollLeft=function(){var t=0;return s.$scrollableArea.parents(":not(body)").each(function(){t+=e(this).scrollLeft()}),t},s.setOptions=function(i){s.options=e.extend({},a,i),s.$scrollableArea=e(s.options.scrollableArea),s.isWindowScrolling=s.$scrollableArea[0]===t},s.updateOptions=function(e){s.setOptions(e),s.unbind(),s.bind(),s.updateWidth(),s.toggleHeaders()},s.init()}var o="stickyTableHeaders",l=0,a={fixedOffset:0,leftOffset:0,marginTop:0,scrollableArea:t};e.fn[o]=function(t){return this.each(function(){var l=e.data(this,"plugin_"+o);l?"string"==typeof t?l[t].apply(l):l.updateOptions(t):"destroy"!==t&&e.data(this,"plugin_"+o,new i(this,t))})}}(jQuery,window);
