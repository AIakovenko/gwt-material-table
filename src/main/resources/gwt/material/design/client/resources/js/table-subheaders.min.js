function TableSubHeaders(t,e){TableSubHeaders.id++;var i=this,o=$(i);i.name="subheaders"+TableSubHeaders.id,i.$window=$(window),i.$document=$(document),i.$tableBody=t.find("tbody"),i.$tableParents=t.parents(),i.$stickies=null,i.options=[],i.cache=[],i.loaded=!1,i.scrollBarWidth=13,i.debug={enabled:!1,smartScroll:{table:0,window:0,outer:0},touchmove:{table:0,window:0,outer:0},resize:{table:0,window:0}};var n={marginTop:0,marginLeft:0,scrollThrottle:10,resizeThrottle:100};i.load=function(t){i.options=$.extend({},n,t),i.scrollBarWidth=$.scrollBarWidth(),i.bind(),i.detect(),i.recalculate(!0),i.loaded=!0},i.unload=function(){i.options=[],i.unbind(),i.$stickies.each(function(){var e=$(this);e.removeClass("fixed").removeClass("passed").removeAttr("style"),e.unwrap(),t.scrollTop(0)}),i.loaded=!1},i.reload=function(){i.unload(),i.load()},i.detect=function(){i.$stickies=$(e,t),i.$stickies.off("."+i.name),i.$stickies.on("tap."+i.name+" click."+i.name,function(){i.toggle($(this))});var o=$(e,t).filter(function(){return $(this).parent().is(":not(div)")});o.each(function(){$(this).wrap("<div style='width:100%;z-index:2;cursor:pointer;background-color:#fff;'/>")})},i.bind=function(){i.unbind();var e=i.options.scrollThrottle,o=i.options.resizeThrottle;t.smartScroll(i.name,$.throttle(e,function(t,e){i.debug.enabled&&i.debug.smartScroll.table++,i.scroll(t,e)})),t.on("resize."+i.name,$.debounce(o,function(){i.debug.enabled&&i.resize.table++,i.recalculate(!0)})),i.$window.smartScroll(i.name,$.throttle(e,function(t,e){i.debug.enabled&&i.debug.smartScroll.window++,i.alignment(t,e)})),i.$window.on("resize."+i.name,$.debounce(o,function(){i.debug.enabled&&i.debug.resize.window++,i.recalculate(!0)})),i.detectOuterScrolls()},i.unbind=function(){t.off("."+i.name),i.$window.off("."+i.name),i.$stickies&&i.$stickies.off("."+i.name),i.$tableParents.each(function(){$(this).off("."+i.name)})},i.detectOuterScrolls=function(){var t=i.options.scrollThrottle;i.$tableParents.off("."+i.name),i.$tableParents.filter(function(){return $(this).hasScrollBar()}).smartScroll(i.name,$.throttle(t,function(t,e){i.debug.enabled&&i.debug.smartScroll.outer++,i.alignment(t,e)}))},i.toggle=function(t){t.hasClass("expanded")?i.close(t):i.open(t)},i.open=function(t){t.addClass("expanded"),o.trigger("opening",[t]);var e=t.find("i");if(null!==e){var n=t.attr("data-close-icon");void 0===n&&(n="remove"),e.text(n)}var r=t.parent(),l=r.nextUntil("div","tr");$.when(l.show(200)).then(function(){i.recalculate(!0),t.trigger("opened",[t])})},i.close=function(t){t.removeClass("expanded"),o.trigger("closing",[t]);var e=t.find("i");if(null!==e){var n=t.attr("data-open-icon");void 0===n&&(n="add"),e.text(n)}var r=t.parent().nextUntil("div");$.when(r.hide(200)).then(function(){i.recalculate(!0),t.trigger("closed",[t])})},i.recalculate=function(e){e&&o.trigger("before-recalculate"),i.detectOuterScrolls(),i.updateHeights();var n=t.scrollTop(),r=i.getOuterScrollTop(),l=i.$tableBody.outerWidth();i.$stickies.each(function(){var t=$(this);t.removeClass("fixed").removeClass("passed").removeAttr("style"),$.data(this,"pos",t.offset().top+r+n+1),i.updateWidth(t,l-2)}),e&&o.trigger("after-recalculate"),i.scroll()},i.scroll=function(e,o){var n=t.offset(),r=t.innerWidth(),l=i.$tableBody.outerWidth(),s=n.top+i.options.marginTop,a=t.scrollTop()+i.getOuterScrollTop(),c=i.$window.scrollTop(),d=n.left+i.options.marginLeft,u=t.scrollLeft(),f=i.getOuterScrollLeft();i.$stickies.each(function(t){var e=$(this),n=!1;if(!o||o.isY()){var h=i.$stickies.eq(t+1),p=i.$stickies.eq(t-1),g=$.data(this,"pos");if(a+s>=g)i.emulateYScroll(e,s,c,a),e.hasClass("passed")||(e.hasClass("fixed")||(e.addClass("fixed"),n=o&&!o.isX()),i.updateWidth(e,l),p.css("display","none"),e.css({display:""}),h.length>0&&a+s>=g-p.outerHeight()&&e.addClass("passed"));else{e.outerWidth();e.removeClass("fixed").removeAttr("style"),p.css({display:""}),p.length>0&&a+s<=g-p.outerHeight()&&p.removeClass("passed")}}(!o||o.isX()||n)&&e.hasClass("fixed")&&i.emulateXScroll(e,r,d,u,f)}),i.$stickies.filter(".passed").each(function(t){var e=$(this),o=i.$stickies.eq(t+1),n=$.data(o[0],"pos")-a-e.outerHeight()-c;e.data("push-back",parseInt(e.css("top").replace("px","")-n)),e.css({top:n})})},i.emulateYScroll=function(t,e,o,n,r){var l=t.outerHeight()+50,s=(r?r:i.getOuterScrollTop())-i.options.marginTop,a=s+"px",c=l+"px",d=t.data("clip-right"),u=t.data("clip-left");if(t.hasClass("passed")){var f=t.data("push-back");a=s+f+"px"}t.data("clip-top",a).data("clip-bottom",c),t.css({top:e-o,clip:"rect("+a+", "+d+", "+c+", "+u+")"})},i.emulateXScroll=function(t,e,o,n,r){var l=n+(r?r:i.getOuterScrollLeft())+"px",s=e+n-i.scrollBarWidth+"px",a=t.data("clip-top")||"auto",c=t.data("clip-bottom")||"auto";t.data("clip-left",l).data("clip-right",s),t.css({left:o-n-i.$window.scrollLeft(),clip:"rect("+a+", "+s+", "+c+", "+l+")"})},i.alignment=function(e,o){var n=t.offset(),r=t.innerWidth(),l=i.$tableBody.outerWidth(),s=!o||o.isX(),a=!o||o.isY(),c=a?i.$window.scrollTop():0,d=a?n.top+i.options.marginTop:0,u=a?t.scrollTop()+i.getOuterScrollTop():0,f=s?n.left+i.options.marginLeft:0,h=s?t.scrollLeft():0,p=s?i.getOuterScrollLeft():0;i.$stickies.filter(".fixed").each(function(t){var e=$(this);if(!o||o.isY()){var n=d;if(e.hasClass("passed")){var a=i.$stickies.eq(t+1);n=$.data(a[0],"pos")-u-e.outerHeight()}i.emulateYScroll(e,n,c,u),i.updateWidth(e,l)}s&&i.emulateXScroll(e,r,f,h,p)})},i.getOuterScrollTop=function(){var t=0;return i.$tableParents.filter(":not(body,html)").each(function(){t+=$(this).scrollTop()}),t},i.getOuterScrollLeft=function(){var t=0;return i.$tableParents.filter(":not(body,html)").each(function(){t+=$(this).scrollLeft()}),t},i.updateCellWidths=function(e){var o=i.getCellWidths($("th,td",$("thead",t)));i.setCellWidths(o,e)},i.setCellWidths=function(t,e){e.find("th,td").each(function(e){var i=$(this),o=t[e];i.css({"min-width":o,"max-width":o})})},i.getCellWidths=function(t){var e=[];return t.each(function(t){var o,n=$(this);if("border-box"===n.css("box-sizing"))o=this.getBoundingClientRect().width;else{var r=$("th",i.$originalHeader);if("collapse"===r.css("border-collapse"))if(window.getComputedStyle)o=parseFloat(window.getComputedStyle(this,null).width);else{var l=parseFloat(n.css("padding-left")),s=parseFloat(n.css("padding-right")),a=parseFloat(n.css("border-width"));o=n.outerWidth()-l-s-a}else o=n.width()}e[t]=o}),e},i.updateWidth=function(t){i.updateCellWidths(t)},i.updateWidths=function(){},i.updateHeights=function(){i.$stickies.each(function(){var t=$(this);t.parent().height(t.outerHeight())})},i.setMarginTop=function(t){i.options.marginTop=t},i.setMarginLeft=function(t){i.options.marginLeft=t},i.isLoaded=function(){return i.loaded},i.getDebugInfo=function(){return i.debug}}TableSubHeaders.id=0,TableSubHeaders.newInstance=function(t,e){return new TableSubHeaders(t,e)};
