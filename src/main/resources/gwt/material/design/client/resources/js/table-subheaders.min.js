function TableSubHeaders(e,t){TableSubHeaders.id++;var i=this,o=$(i);i.name="subheaders"+TableSubHeaders.id,i.$window=$(window),i.$document=$(document),i.$tableBody=e.find("tbody"),i.$tableParents=e.parents(),i.$stickies=null,i.options=[],i.cache=[],i.loaded=!1,i.scrollBarWidth=13,i.debug={enabled:!0,smartScroll:{table:0,window:0,outer:0},touchmove:{table:0,window:0,outer:0},resize:{table:0,window:0}};var n={marginTop:0,marginLeft:0,scrollThrottle:20,resizeThrottle:100};i.load=function(e){i.options=$.extend({},n,e),i.scrollBarWidth=$.scrollBarWidth(),i.bind(),i.detect(),i.recalculate(!0),i.loaded=!0},i.unload=function(){i.options=[],i.unbind(),i.$stickies.each(function(){var t=$(this);t.removeClass("fixed").removeClass("passed").removeAttr("style"),t.unwrap(),e.scrollTop(0)}),i.loaded=!1},i.reload=function(){i.unload(),i.load()},i.detect=function(){i.$stickies=$(t,e),i.$stickies.off("."+i.name),i.$stickies.on("tap."+i.name+" click."+i.name,function(){i.toggle($(this))});var o=$(t,e).filter(function(){return $(this).parent().is(":not(div)")});o.each(function(){$(this).wrap("<div style='width:100%;z-index:2;cursor:pointer;background-color:#fff;'/>")})},i.bind=function(){i.unbind();var t=i.options.scrollThrottle,o=i.options.resizeThrottle;e.smartScroll(i.name,$.throttle(t,function(e,t){i.debug.enabled&&i.debug.smartScroll.table++,i.scroll(e,t)})),e.on("resize."+i.name,$.debounce(o,function(){i.debug.enabled&&i.resize.table++,i.recalculate(!0)})),i.$window.smartScroll(i.name,$.throttle(t,function(e,t){i.debug.enabled&&i.debug.smartScroll.window++,i.alignment(e,t)})),i.$window.on("resize."+i.name,$.debounce(o,function(){i.debug.enabled&&i.debug.resize.window++,i.recalculate(!0)})),i.detectOuterScrolls()},i.unbind=function(){e.off("."+i.name),i.$window.off("."+i.name),i.$stickies&&i.$stickies.off("."+i.name),i.$tableParents.each(function(){$(this).off("."+i.name)})},i.detectOuterScrolls=function(){var e=i.options.scrollThrottle;i.$tableParents.off("."+i.name),i.$tableParents.filter(function(){return $(this).hasScrollBar()}).smartScroll(i.name,$.throttle(e,function(e,t){i.debug.enabled&&i.debug.smartScroll.outer++,i.alignment(e,t)}))},i.toggle=function(e){e.hasClass("expanded")?i.close(e):i.open(e)},i.open=function(e){e.addClass("expanded"),o.trigger("opening",[e]);var t=e.find("i");if(null!=t){var n=e.attr("data-close-icon");void 0===n&&(n="remove"),t.text(n)}var r=e.parent(),l=r.nextUntil("div","tr");$.when(l.show(200)).then(function(){i.recalculate(!0),e.trigger("opened",[e])})},i.close=function(e){e.removeClass("expanded"),o.trigger("closing",[e]);var t=e.find("i");if(null!=t){var n=e.attr("data-open-icon");void 0===n&&(n="add"),t.text(n)}var r=e.parent().nextUntil("div");$.when(r.hide(200)).then(function(){i.recalculate(!0),e.trigger("closed",[e])})},i.recalculate=function(t){t&&o.trigger("before-recalculate"),i.detectOuterScrolls(),i.updateHeights();var n=e.scrollTop(),r=i.getOuterScrollTop(),l=i.$tableBody.outerWidth();i.$stickies.each(function(){var e=$(this);e.removeClass("fixed").removeClass("passed").removeAttr("style"),$.data(this,"pos",e.offset().top+r+n+1),i.updateWidth(e,l-2)}),t&&o.trigger("after-recalculate"),i.scroll()},i.scroll=function(t,o){var n=e.offset(),r=e.innerWidth(),l=i.$tableBody.outerWidth(),s=n.top+i.options.marginTop,a=e.scrollTop()+i.getOuterScrollTop(),d=i.$window.scrollTop(),c=n.left+i.options.marginLeft,u=e.scrollLeft(),f=i.getOuterScrollLeft();i.$stickies.each(function(e){var t=$(this),n=!1;if(!o||o.isY()){var h=i.$stickies.eq(e+1),p=i.$stickies.eq(e-1),g=$.data(this,"pos");if(a+s>=g)i.emulateYScroll(t,s,d,a),t.hasClass("passed")||(t.hasClass("fixed")||(t.addClass("fixed"),n=o&&!o.isX()),i.updateWidth(t,l),p.css("display","none"),t.css({display:""}),h.length>0&&a+s>=g-p.outerHeight()&&t.addClass("passed"));else{var b=t.outerWidth();t.removeClass("fixed").removeAttr("style"),t.width(b),p.css({display:""}),p.length>0&&a+s<=g-p.outerHeight()&&p.removeClass("passed")}}(!o||o.isX()||n)&&t.hasClass("fixed")&&i.emulateXScroll(t,r,c,u,f)}),i.$stickies.filter(".passed").each(function(e){var t=$(this),o=i.$stickies.eq(e+1),n=$.data(o[0],"pos")-a-t.outerHeight()-d;t.data("push-back",parseInt(t.css("top").replace("px","")-n)),t.css({top:n})})},i.emulateYScroll=function(e,t,o,n,r){var l=e.outerHeight()+50,s=(r?r:i.getOuterScrollTop())-i.options.marginTop,a=s+"px",d=l+"px",c=e.data("clip-right"),u=e.data("clip-left");if(e.hasClass("passed")){var f=e.data("push-back");a=s+f+"px"}e.data("clip-top",a).data("clip-bottom",d),e.css({top:t-o,clip:"rect("+a+", "+c+", "+d+", "+u+")"})},i.emulateXScroll=function(e,t,o,n,r){var l=n+(r?r:i.getOuterScrollLeft())+"px",s=t+n-i.scrollBarWidth+"px",a=e.data("clip-top")||"auto",d=e.data("clip-bottom")||"auto";e.data("clip-left",l).data("clip-right",s),e.css({left:o-n-i.$window.scrollLeft(),clip:"rect("+a+", "+s+", "+d+", "+l+")"})},i.alignment=function(t,o){var n=e.offset(),r=e.innerWidth(),l=i.$tableBody.outerWidth(),s=!o||o.isX(),a=!o||o.isY(),d=a?i.$window.scrollTop():0,c=a?n.top+i.options.marginTop:0,u=a?e.scrollTop()+i.getOuterScrollTop():0,f=s?n.left+i.options.marginLeft:0,h=s?e.scrollLeft():0,p=s?i.getOuterScrollLeft():0;i.$stickies.filter(".fixed").each(function(e){var t=$(this);if(!o||o.isY()){var n=c;if(t.hasClass("passed")){var a=i.$stickies.eq(e+1);n=$.data(a[0],"pos")-u-t.outerHeight()}i.emulateYScroll(t,n,d,u),i.updateWidth(t,l)}s&&i.emulateXScroll(t,r,f,h,p)})},i.getOuterScrollTop=function(){var e=0;return i.$tableParents.filter(":not(body,html)").each(function(){e+=$(this).scrollTop()}),e},i.getOuterScrollLeft=function(){var e=0;return i.$tableParents.filter(":not(body,html)").each(function(){e+=$(this).scrollLeft()}),e},i.updateCellWidths=function(t){var o=i.getCellWidths($("th,td",$("thead",e)));i.setCellWidths(o,t)},i.setCellWidths=function(e,t){t.find("th,td").each(function(t){$(this),e[t]})},i.getCellWidths=function(e){var t=[];return e.each(function(e){var o,n=$(this);if("border-box"===n.css("box-sizing"))o=this.getBoundingClientRect().width;else{var r=$("th",i.$originalHeader);if("collapse"===r.css("border-collapse"))if(window.getComputedStyle)o=parseFloat(window.getComputedStyle(this,null).width);else{var l=parseFloat(n.css("padding-left")),s=parseFloat(n.css("padding-right")),a=parseFloat(n.css("border-width"));o=n.outerWidth()-l-s-a}else o=n.width()}t[e]=o}),t},i.updateWidth=function(e,t){t&&e.width(t),i.updateCellWidths(e)},i.updateWidths=function(){i.$stickies.each(function(){i.updateWidth($(this))})},i.updateHeights=function(){i.$stickies.each(function(){var e=$(this);e.parent().height(e.outerHeight())})},i.setMarginTop=function(e){i.options.marginTop=e},i.setMarginLeft=function(e){i.options.marginLeft=e},i.isLoaded=function(){return i.loaded},i.getDebugInfo=function(){return i.debug}}TableSubHeaders.id=0,TableSubHeaders.newInstance=function(e,t){return new TableSubHeaders(e,t)};
