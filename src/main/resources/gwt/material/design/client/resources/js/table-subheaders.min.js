function TableSubHeaders(e,t){TableSubHeaders.id++;var i=this,o=$(i);i.name="subheaders"+TableSubHeaders.id,i.$window=$(window),i.$document=$(document),i.$tableBody=e.find("tbody"),i.$tableParents=e.parents(),i.$stickies=null,i.options=[],i.cache=[],i.loaded=!1,i.scrollBarWidth=13,i.debug={enabled:!1,smartScroll:{table:0,window:0,outer:0},touchmove:{table:0,window:0,outer:0},resize:{table:0,window:0}};var n={marginTop:0,marginLeft:0,scrollThrottle:10,resizeThrottle:100};i.load=function(e){i.options=$.extend({},n,e),i.bind(),i.detect(),i.recalculate(!0),i.loaded=!0},i.unload=function(){i.options=[],i.unbind(),i.$stickies.each(function(){var t=$(this);t.removeClass("fixed").removeClass("passed").removeAttr("style"),t.unwrap(),e.scrollTop(0)}),i.loaded=!1},i.reload=function(){i.unload(),i.load()},i.detect=function(){if(i.$stickies=$(t,e),!(i.$stickies.length<1)){i.$stickies.off("."+i.name),i.$stickies.on("tap."+i.name+" click."+i.name,function(){i.toggle($(this))});var o=$(t,e).filter(function(){return $(this).parent().is(":not(div)")}),n=i.isChrome();o.each(function(){$(this).wrap("<div style='width:100%;z-index:2;cursor:pointer;background-color:#fff;"+(n?"":"display:table-row;")+"'/>")})}},i.bind=function(){i.unbind();var t=i.options.scrollThrottle,o=i.options.resizeThrottle;e.smartScroll(i.name,$.throttle(t,function(e,t){i.debug.enabled&&i.debug.smartScroll.table++,i.scroll(e,t)})),e.find(".inner-scroll").smartScroll(i.name,$.throttle(t,function(e,t){i.debug.enabled&&i.debug.smartScroll.table++,i.scroll(e,t)})),e.on("resize."+i.name,$.debounce(o,function(){i.debug.enabled&&i.resize.table++,i.recalculate(!0)})),i.$window.smartScroll(i.name,$.throttle(t,function(e,t){i.debug.enabled&&i.debug.smartScroll.window++,i.alignment(t)})),i.$window.on("resize."+i.name,$.debounce(o,function(){i.debug.enabled&&i.debug.resize.window++,i.recalculate(!0)})),i.detectOuterScrolls()},i.unbind=function(){e.off("."+i.name),i.$window.off("."+i.name),i.$stickies&&i.$stickies.off("."+i.name),i.$tableParents.each(function(){$(this).off("."+i.name)})},i.detectOuterScrolls=function(){var e=i.options.scrollThrottle;i.$tableParents.off("."+i.name),i.$tableParents.filter(function(){return $(this).hasScrollBar()}).smartScroll(i.name,$.throttle(e,function(e,t){i.debug.enabled&&i.debug.smartScroll.outer++,i.alignment(t)}))},i.toggle=function(e){e.hasClass("expanded")?i.close(e):i.open(e)},i.open=function(e){e.addClass("expanded"),o.trigger("opening",[e]);var t=e.find("i");if(null!==t){var n=e.attr("data-close-icon");void 0===n&&(n="remove"),t.text(n)}var a=e.parent(),l=a.nextUntil("div","tr");$.when(l.show(200)).then(function(){i.recalculate(!0),e.trigger("opened",[e])})},i.close=function(e){e.removeClass("expanded"),o.trigger("closing",[e]);var t=e.find("i");if(null!==t){var n=e.attr("data-open-icon");void 0===n&&(n="add"),t.text(n)}var a=e.parent().nextUntil("div");$.when(a.hide(200)).then(function(){i.recalculate(!0),e.trigger("closed",[e])})},i.recalculate=function(t){if(!(i.$stickies.length<1)){t&&o.trigger("before-recalculate"),i.scrollBarWidth=$.scrollBarWidth(i.$tableBody.get(0)),i.detectOuterScrolls(),i.updateHeights();var n=e.scrollTop(),a=i.getOuterScrollTop(),l=i.$tableBody.outerWidth();i.$stickies.each(function(){var e=$(this);e.removeClass("fixed").removeClass("passed").removeAttr("style"),$.data(this,"pos",e.offset().top+a+n+1),i.updateWidth(e,l-2)}),t&&o.trigger("after-recalculate"),i.scroll()}},i.scroll=function(t,o){var n=e.offset(),a=e.innerWidth(),l=i.$tableBody.outerWidth(),r=n.top+i.options.marginTop,s=e.scrollTop()+i.getOuterScrollTop(),c=i.$window.scrollTop(),d=n.left+i.options.marginLeft,u=e.find(".inner-scroll").scrollLeft(),f=i.getOuterScrollLeft();i.$stickies.each(function(e){var t=$(this),n=!1;if(!o||o.isY()){var h=i.$stickies.eq(e+1),p=i.$stickies.eq(e-1),g=$.data(this,"pos");if(s+r>=g)i.emulateYScroll(t,r,c,s),t.hasClass("passed")||(t.hasClass("fixed")||(t.addClass("fixed"),n=o&&!o.isX()),i.updateWidth(t,l),p.css("display","none"),t.css({display:""}),h.length>0&&s+r>=g-p.outerHeight()&&t.addClass("passed"));else{t.outerWidth();t.removeClass("fixed").removeAttr("style"),p.css({display:""}),p.length>0&&s+r<=g-p.outerHeight()&&p.removeClass("passed")}}(!o||o.isX()||n)&&t.hasClass("fixed")&&i.emulateXScroll(t,a,d,u,f)}),i.$stickies.filter(".passed").each(function(e){var t=$(this),o=i.$stickies.eq(e+1),n=$.data(o[0],"pos")-s-t.outerHeight()-c;t.data("push-back",parseInt(t.css("top").replace("px","")-n)),t.css({top:n})})},i.emulateYScroll=function(t,o,n,a,l){var r=(e.offset(),t.outerHeight()+50),s=(l?l:i.getOuterScrollTop())-i.options.marginTop-e.position().top,c=s+"px",d=r+"px",u=t.data("clip-right"),f=t.data("clip-left");if(t.hasClass("passed")){var h=t.data("push-back");c=s+h+"px"}t.data("clip-top",c).data("clip-bottom",d),t.css({top:o-n,clip:"rect("+c+", "+u+", "+d+", "+f+")"})},i.emulateXScroll=function(e,t,o,n,a){var l=n+(a?a:i.getOuterScrollLeft())+"px",r=t+n-i.scrollBarWidth+"px",s=e.data("clip-top")||"auto",c=e.data("clip-bottom")||"auto";e.data("clip-left",l).data("clip-right",r),e.css({left:o-n-i.$window.scrollLeft(),clip:"rect("+s+", "+r+", "+c+", "+l+")"})},i.alignment=function(t){if(!(i.$stickies.length<1)){var o=e.offset(),n=e.innerWidth(),a=i.$tableBody.outerWidth(),l=!t||t.isX(),r=!t||t.isY(),s=r?i.$window.scrollTop():0,c=r?o.top+i.options.marginTop:0,d=r?e.scrollTop()+i.getOuterScrollTop():0,u=l?o.left+i.options.marginLeft:0,f=l?e.find(".inner-scroll").scrollLeft():0,h=l?i.getOuterScrollLeft():0;i.$stickies.filter(".fixed").each(function(e){var o=$(this);if(!t||t.isY()){var r=c;if(o.hasClass("passed")){var p=i.$stickies.eq(e+1);r=$.data(p[0],"pos")-d-o.outerHeight()}i.emulateYScroll(o,r,s,d),i.updateWidth(o,a)}l&&i.emulateXScroll(o,n,u,f,h)})}},i.getOuterScrollTop=function(){var e=0;return i.$tableParents.filter(":not(body,html)").each(function(){e+=$(this).scrollTop()}),e},i.getOuterScrollLeft=function(){var e=0;return i.$tableParents.filter(":not(body,html)").each(function(){e+=$(this).scrollLeft()}),e},i.updateCellWidths=function(t){var o=i.getCellWidths($("th,td",$("thead",e)));i.setCellWidths(o,t)},i.setCellWidths=function(e,t){t.find("th,td").each(function(t){var i=$(this),o=e[t];i.css({"min-width":o,"max-width":o})})},i.getCellWidths=function(e){var t=[];return e.each(function(e){var o,n=$(this);if("border-box"===n.css("box-sizing"))o=this.getBoundingClientRect().width;else{var a=$("th",i.$originalHeader);if("collapse"===a.css("border-collapse"))if(window.getComputedStyle)o=parseFloat(window.getComputedStyle(this,null).width);else{var l=parseFloat(n.css("padding-left")),r=parseFloat(n.css("padding-right")),s=parseFloat(n.css("border-width"));o=n.outerWidth()-l-r-s}else o=n.width()}t[e]=o}),t},i.updateWidth=function(e){i.updateCellWidths(e)},i.updateWidths=function(){},i.updateHeights=function(){i.$stickies.each(function(){var e=$(this),t=e.attr("data-height");"undefined"==typeof t&&(t=e.outerHeight()),e.parent().height(t+1)})},i.updateHeight=function(e,t){$.contains(i.$stickies,$(e))&&$(e).parent().height(t)},i.setMarginTop=function(e){i.options.marginTop=e},i.setMarginLeft=function(e){i.options.marginLeft=e},i.isLoaded=function(){return i.loaded},i.getDebugInfo=function(){return i.debug},i.isChrome=function(){return!!window.chrome&&!i.isOpera()},i.isOpera=function(){return!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0}}TableSubHeaders.id=0,TableSubHeaders.newInstance=function(e,t){return new TableSubHeaders(e,t)};
